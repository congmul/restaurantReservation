<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tables Page</title>

    <!-- Bootstrap Link -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">

    <!-- Font AweSome Link CDN-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">

    <!-- jQuery Link-->
    <script src="https://code.jquery.com/jquery.js"></script>

</head>

<body>
    <div class="container-md">
        <div class="jumbotron" style="text-align: center;">
            <h1 class="display-4" style="font-weight: 600; font-size: 40px"><i class="fab fa-gripfire"></i> Hot
                Restaurant</h1>
            <hr class="my-4">
            <p class="lead" style="font-weight: 500; font-size: 35px">We only have 5 tables! Book your seat before they
                all are gone!</p>

            <a class="btn btn-danger btn-lg" href="/reserve" role="button"><i class="fas fa-receipt"></i> Make
                Reservation</a>
            <a class="btn btn-primary btn-lg" href="/" role="button"><i class="fas fa-home"></i></a>
        </div>
        <div class="card mb-5" style="font-weight: 600; font-size: 25px">
            <div class="card-header">
                Current Reservations
            </div>
            <div class="card-body" id="tableResult">
                <!-- Result Form -->
            </div>
        </div>
        <div class="card mb-3" style="font-weight: 600; font-size: 25px">
            <div class="card-header">
                Waiting List
            </div>
            <div class="card-body" id="waitingListResult">
                <!-- Result Form -->
                <div class="border" id="waitingList">
                    <!-- <div class="mt-3 ml-3 mb-3">
                        <p class="card-text">{Table} {#}${1}</p>
                    <hr class="my-4">
                    <p class="card-text">{ID}: ${ID}</p>
                    <p class="card-text">{Name}: ${Name}</p>
                    <p class="card-text">{Email}: ${Email}</p>
                    <p class="card-text">{Phone}: ${Phone}</p>
                    </div> -->
                </div>
            </div>
        </div>
        <div class="mb-5 link">
            <a href="#" id="clearTable">Clear Table</a> | <a href="/api/tables">API Table Link</a> | <a
                href="/api/waitlist">API Wait List</a>
        </div>
    </div>
</body>
<script type="text/javascript">
    display();
    function display() {
        $.get("/api/tables", (data) => {
            console.log("Reservation Table");
            console.log(data);
            // console.log(JSON.parse(data));
            if (data.length >= 1) {
                data.forEach(element => {
                    parseElement = JSON.parse(element);
                    console.log(parseElement);
                    // $("#tables").show();

                    let topDiv = $("<div>");
                    let div = $("<div>");
                    let tableEl = $("<p>");
                    let hrEl = $("<hr>");
                    let idEl = $("<p>");
                    let nameEl = $("<p>");
                    let emailEl = $("<p>");
                    let phoneEl = $("<p>");
                    
                    topDiv.attr("class", "border mb-4");
                    // topDiv.attr("id", "border");
                    div.attr("class", "mt-3 ml-3 mb-3");
                    hrEl.attr("class", "my-4");
                    idEl.attr("class", "card-text");
                    nameEl.attr("class", "card-text");
                    emailEl.attr("class", "card-text");
                    phoneEl.attr("class", "card-text");

                        
                    console.log(parseElement.id);
                    tableEl.text("Table #" + parseElement.id);
                    idEl.text("ID: " + parseElement.id);
                    nameEl.text("Name: " + parseElement.name);
                    emailEl.text("Email: " + parseElement.email);
                    phoneEl.text("Phone: " + parseElement.phoneNumber);

                    div.append(tableEl);
                    div.append(hrEl);
                    div.append(idEl);
                    div.append(nameEl);
                    div.append(emailEl);
                    div.append(phoneEl);

                    topDiv.append(div);

                    $("#tableResult").append(topDiv);
                });
            } 
            // else {
            //     $("#tables").hide();
            // }
        });

        $.get("/api/waitlist", (data) => {
            console.log("Wainting List Table");
            console.log(data);
            if (data.length >= 1) {
                $("#waitingList").show();
                data.forEach(element => {
                    parseElement = JSON.parse(element);

                    let topDiv = $("<div>");
                    let div = $("<div>");
                    let tableEl = $("<p>");
                    let hrEl = $("<hr>");
                    let idEl = $("<p>");
                    let nameEl = $("<p>");
                    let emailEl = $("<p>");
                    let phoneEl = $("<p>");

                    
                    topDiv.attr("class", "border mb-4");
                    div.attr("class", "mt-3 ml-3 mb-3");
                    hrEl.attr("class", "my-4");
                    idEl.attr("class", "card-text");
                    nameEl.attr("class", "card-text");
                    emailEl.attr("class", "card-text");
                    phoneEl.attr("class", "card-text");
                    
                    tableEl.text("Table #" + parseElement.id);
                    idEl.text("ID:" + parseElement.id);
                    nameEl.text("Name: " + parseElement.name);
                    emailEl.text("Email: " + parseElement.email);
                    phoneEl.text("Phone: " + parseElement.phoneNumber);

                    div.append(tableEl);
                    div.append(hrEl);
                    div.append(idEl);
                    div.append(nameEl);
                    div.append(emailEl);
                    div.append(phoneEl);

                    topDiv.append(div);

                    $("#waitingListResult").append(topDiv);

                });

            } else {
                $("#waitingList").hide();
            }
        });
    }

    function clearTable(){
        alert("Clearing...");
        $.ajax({
            url:"/api/clear",
            method: "POST" }).then(function(){
                $("#tableResult").empty();
                $("#waitingList").empty();
            });
    }
    $("#clearTable").on("click", clearTable);

</script>

</html>